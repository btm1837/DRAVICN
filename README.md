# DRAVICN
Dynamic Routing of Autonomous Vehilces In Coordinated Networks

## network_file_genorator.py input file format
The network generation file uses several inputs within the python file itself however the primary setup file is structured as follows:
```
horizontal_roads:
    set1:
        number: {Define the number of road segments you would like with this characteristic, if you want this to be the default write "fill"}
        speed : {Define the road free flow speed in mph}
    ...
    setn:
        ...
    ...
    total_number: {Define the total number of horizontal roads, if the sum of the number arguments is less than total "fill" sets will be used to fill the network}
vertical_roads:
    set1:
        number: {Define the number of road segments you would like with this characteristic, if you want this to be the default write "fill"}
        speed : {Define the road free flow speed in mph}
    ...
    set{n}:
        ...
    ...
    total_number: {Define the total number of horizontal roads, if the sum of the number arguments is less than total "fill" sets will be used to fill the network}
source_nodes:
    total_number: { number from 1 upwards}
    source1:
        grid_location: {N,E,S,W relating to North, East, South or West on the grid}
        road_location: {"top" or "bottom" relats which kind of horizontal road to link to}
        uniform_flow_per_hour: {Number of vehicles that will flow in from the node per hour}
    ...
    source{n}:
        ...
sink_nodes:
    total_number: { number from 1 upwards}
    sink1:
        grid_location: {N,E,S,W relating to North, East, South or West on the grid}
        road_location: {"top" or "bottom" relats which kind of horizontal road to link to}
        uniform_flow_per_hour: {Number of vehicles that will flow out of the node per hour}
    ...
    sink{n}:
        ...
grid_dimensions:
    horizontal_length: {number of horizontal roads}
    vertical_length: {number of vertical roads}
experiment_constants:
    simulation_time_interval: {simulation time interval in seconds, used to calculate node and arc length}
run_id: {folder location / id for this experiment set }
path: {path to the run_id output folder}
```

### An example yaml file 
```
horizontal_roads:
    set1:
        number: 4
        speed: 30
    set2:
        number: 1
        speed: 40
    set3:
        speed: 20
        number: fill
    total_number: 6
vertical_roads:
    set1:
        number: 4
        speed: 30
    set2:
        number: 1
        speed: 40
    set3:
        speed: 20
        number: 1
    total_number: 6
source_nodes:
    total_number: 1
    source1:
        grid_location: "W"
        road_location: "top"
        uniform_flow_per_hour: 4000
    source2:
        grid_location: "E"
        road_location: "top"
        uniform_flow_per_hour: 4000
sink_nodes:
    total_number: 1
    sink1:
        grid_location: "E"
        road_location: "bottom"
        uniform_flow_per_hour: 4000
    sink2:
        grid_location: "W"
        road_location: "bottom"
        uniform_flow_per_hour: 4000
grid_dimensions:
    horizontal_length: 6
    vertical_length: 6
experiment_constants:
    simulation_time_interval: 30
run_id: setup_6
path: D:\Documents\Thesis_Docs\experiment_files\setup_yaml
```

## Run.py Model Inputs
Run.py has 3 neccessary model inputs, 1 of which comes from the network generation script. The other two inputs are manually generated ".csv" files.

### arcs_{run_id}.csv
Generated by the network_file_genorator.py. Describes the entire network of arcs and nodes that the simulation will use. Each line represents an arc, every arc in the simulation is unidirectional, (having only one direction vehicle are allowed to flow in.) 
- Start
  - The node at the start of the arc
- End
  - The node at the end of the arc
- Free_Flow_Speed
  - The mph that the vehicles move down the arc
- Direction
  - The direction the arc is facing four possible options, N, E, S, W. 

#### Example first five lines of an arcs_.csv File
```
Start,End,Free_Flow_Speed,Direction
a,b,30,E
b,a,30,W
b,c,30,E
c,b,30,W
```

### Experiments.csv
Contains several feilds that control the experimental design:
- Experiment:
  - Experiment id number
- Coordination:
  - whether or not this experiment should contain coordination throughout
- Coordination period:
  - Depricated flag for controling the length of the coordination interval
- Demand Multiplier:
  - Depricated flag for controling a multiplier on the source sink uniform flow per hour
- Cell Travel Time Calculation
  - Deplicated flag for selecting one of several ways of how the the cell travel time is calculated and communicated back to its respective arc
- Simulation Time Interval
  - Number of seconds that each simulation time interval represents (typically 30)
- Total Simulation Time
  - The total number of seconds to run the simulation for
- vehicle_length
  - The length of vehicles in the simulation, used for CTM and ICP calculations 
- Trials
  - Number of repititions to do of this experiment
- Exper_flow
  - Depricated parameter


#### Example Experiments.csv File
```
Experiment,Coordination,Coordination_Period,Demand_Multiplier,Cell_Travel_Time_Calc,Simulation_Time_Interval,Total_Simulation_Time,vehicle_length,trials,exper_flow
0,1,1,10,0,30,900,0.0037,1,0
```

### Vehicles.csv
Vehicles.csv is used for controling different vehicle mixes within the experiment setup, currently depricated capability to have a mix of vehicles in the same experiment
- Manufacturer
  - unique id for this vehicle type, when using several vehicle types in the same simulation
- reaction time
  - the number of seconds it takes the vehicle to react to traffic conditions, affects CTM and congestion calculations within the simulation

#### Example Vehicles.csv File
```
Manufacturer,Reaction_time
0,0.000138889
```

## Additional Setup
Obtain a free academic gurobi license by creating an account on the gurobi website and requesting an academic license
- https://www.gurobi.com/academia/academic-program-and-licenses/
Follow the directions on their website to install it on your local machine, you will need to be on an academic VPN to obtain the license, however do not need to be on the VPN to use the solver. 
